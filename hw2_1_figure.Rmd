---
title: "hw2_1_figure"
author: "Zixuan Yu"
date: "2/25/2022"
output: html_document
---
**b. plot width **  

```{r}
## Equal Sample Size
s2 = seq(1,100, length=1000)
n1 = 1600
n2 = 1600
var_beta1 = s2/n1 + 2*s2/n2
var_beta2 = s2/n1 + 1*s2/n2
df = n1+n2-2
width1 = 2*qt(0.975, df = df )*sqrt(var_beta1)/df
width2 = 2*qt(0.975, df = df )*sqrt(var_beta2)/df
plot(s2, width1, col='lightblue')
points(s2, width2, col='pink')

```

  

```{r}
## Unequal Sample Size
s2 = seq(1,100, length=1000)
n1 = 3200
n2 = 1600
var_beta1 = s2/n1 + 2*s2/n2
var_beta2 = s2/n1 + 1*s2/n2
df = n1+n2-2
width1 = 2*qt(0.975, df = df )*sqrt(var_beta1)/df
width2 = 2*qt(0.975, df = df )*sqrt(var_beta2)/df
df1 <- data.frame(sigma2 = s2, width = c(width1,width2), model = c(rep("True model",1000), rep("model1",1000)) )
library(ggplot2)
ggplot(data=df1, aes(x=sigma2, y=width, color=model))+geom_point(size=3) +
  labs(title = "Width of 95% Confidence interval for B1") +
  theme(panel.border = element_blank(), 
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        axis.line = element_line(colour = "black"),
        plot.title = element_text(size = 18, face = "bold")) 

```
  
Whether sample size are equal or not does not seems to influence the shape of the curve. The true model has larger with, and the relationship between $\sigma^2$ and width is not linear. By assuming same variance across groups, we will bias standard error done, thus getting a smaller width of the confidence interval.  A more flexible model that would allow the variance of the residuals to depend on the treatment group will more accurately reflec the reality.  



5.	OPTIONAL:  Under the Gaussian multiple linear regression framework, write the log likelihood function for the regression coefficients and residual variance in matrix terms and derive the mleâ€™s for the regression coefficients. Derive their joint distribution, as well as the distribution of the predicted values and residuals.  